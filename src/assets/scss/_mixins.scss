@use "sass:math";
@use "sass:list";
@use "sass:meta"; 
@use "sass:map";
@use "sass:string";
@use "sass:color";

// px → rem 단일 변환
@function px-to-rem($value, $base: 16) {
  @if math.is-unitless($value) { $value: $value * 1px; }
  @if math.unit($value) != "px" {
    @error "px-to-rem expects pixel values, got #{math.unit($value)}.";
  }
  @return math.div(math.div($value, 1px), $base) * 1rem;
}

// ✅ shorthand 지원 px()
@function px($values...) {
  $base: 16;

  // 마지막 인자가 map이면 base 추출 + 마지막 요소 제거(안전 방식)
  @if list.length($values) > 0 and meta.type-of(list.nth($values, list.length($values))) == "map" {
    $opts: list.nth($values, list.length($values));

    @if map.has-key($opts, base) {
      $base: map.get($opts, base);
    }

    // ✅ list.slice 대신: 마지막 요소 빼고 새 리스트 생성
    $trimmed: ();
    @for $i from 1 through (list.length($values) - 1) {
      $trimmed: list.append($trimmed, list.nth($values, $i), space);
    }
    $values: $trimmed;
  }

  // 값이 1개인데 그게 리스트면 풀어줌: px((20 15 10 5))
  @if list.length($values) == 1 and meta.type-of(list.nth($values, 1)) == "list" {
    $values: list.nth($values, 1);
  }

  $out: ();
  @for $i from 1 through list.length($values) {
    $v: list.nth($values, $i);

    @if $v == 0 {
      $out: list.append($out, 0, space); 
    } @else {
      $out: list.append($out, px-to-rem($v, $base), space); 
    }
  }

  @if list.length($out) == 1 {
    @return list.nth($out, 1);
  }
  @return $out;
}

// ✅ 기존 믹스인 유지(단일값용 + max- 지원)
@mixin px($property, $value, $max: null, $base: 16) {
  #{$property}: px($value, (base: $base));

  @if $max != null {
    max-#{$property}: px($max, (base: $base));
  }
}

// ===== 보더 애니메이션 Mixin =====
// 회전하는 그라데이션 보더 애니메이션
@mixin border-animation-rotate($border-width: 2px, $colors: (#0c7c59, #4ade80, #0c7c59), $duration: 3s) {
  position: relative;
  background: var(--color-card, #fff);
  border-radius: px(8);
  z-index: 0;

  &::before {
    content: "";
    position: absolute;
    inset: 0;
    border-radius: inherit;
    padding: $border-width;
    background: linear-gradient(45deg, $colors);
    background-size: 300% 300%;
    -webkit-mask: linear-gradient(#fff 0 0) content-box, linear-gradient(#fff 0 0);
    -webkit-mask-composite: xor;
    mask: linear-gradient(#fff 0 0) content-box, linear-gradient(#fff 0 0);
    mask-composite: exclude;
    animation: border-rotate $duration linear infinite;
    z-index: -1;
  }
}

// 반짝이는 보더 애니메이션 (회전하면서 반짝임)
@mixin border-animation-shimmer($border-width: 2px, $color: #0c7c59, $duration: 2s) {
  position: relative;
  background: var(--color-card, #fff);
  border-radius: px(8);
  z-index: 0;

  &::before {
    content: "";
    position: absolute;
    inset: 0;
    border-radius: inherit;
    padding: $border-width;
    background: conic-gradient(
      from 0deg,
      transparent 0deg,
      transparent 60deg,
      $color 90deg,
      color.adjust($color, $lightness: 15%) 120deg,
      $color 150deg,
      transparent 210deg,
      transparent 270deg,
      $color 300deg,
      color.adjust($color, $lightness: 15%) 330deg,
      $color 360deg
    );
    -webkit-mask: linear-gradient(#fff 0 0) content-box, linear-gradient(#fff 0 0);
    -webkit-mask-composite: xor;
    mask: linear-gradient(#fff 0 0) content-box, linear-gradient(#fff 0 0);
    mask-composite: exclude;
    animation: border-shimmer-rotate $duration linear infinite;
    z-index: -1;
  }
}

// 펄스 보더 애니메이션
@mixin border-animation-pulse($border-width: 2px, $color: #0c7c59, $duration: 2s) {
  position: relative;
  background: var(--color-card, #fff);
  border-radius: px(8);
  border: $border-width solid $color;
  animation: border-pulse $duration ease-in-out infinite;
  
  @keyframes border-pulse {
    0%, 100% {
      border-color: $color;
      box-shadow: 0 0 0 0 rgba($color, 0.6);
    }
    50% {
      $lightened: color.adjust($color, $lightness: 20%);
      border-color: $lightened;
      box-shadow: 0 0 0 px(12) rgba($color, 0.2), 0 0 0 px(20) rgba($color, 0);
    }
  }
} 

// 그라데이션 보더 애니메이션 (위에서 아래로)
@mixin border-animation-gradient($border-width: 2px, $colors: (#0c7c59, #4ade80), $duration: 3s) {
  position: relative;
  background: var(--color-card, #fff);
  border-radius: px(8);
  z-index: 0;

  &::before {
    content: "";
    position: absolute;
    inset: 0;
    border-radius: inherit;
    padding: $border-width;
    background: linear-gradient(180deg, $colors);
    background-size: 100% 200%;
    -webkit-mask: linear-gradient(#fff 0 0) content-box, linear-gradient(#fff 0 0);
    -webkit-mask-composite: xor;
    mask: linear-gradient(#fff 0 0) content-box, linear-gradient(#fff 0 0);
    mask-composite: exclude;
    animation: border-gradient $duration linear infinite;
    z-index: -1;
  }
}

// 애니메이션 키프레임
@keyframes border-rotate {
  0% {
    background-position: 0% 0%;
  }
  25% {
    background-position: 100% 0%;
  }
  50% {
    background-position: 100% 100%;
  }
  75% {
    background-position: 0% 100%;
  }
  100% {
    background-position: 0% 0%;
  }
}

@keyframes border-shimmer-rotate {
  0% {
    transform: rotate(0deg);
  }
  100% {
    transform: rotate(360deg);
  }
}


@keyframes border-gradient {
  0% {
    background-position: 0% 0%;
  }
  100% {
    background-position: 0% 100%;
  }
}


